<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
    <title>승선99 | 스파르타</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="stylesheet" href="../static/assets/css/main.css"/>
    <link rel="shortcut icon" type="image/x-icon" href="../static/images/hh99.ico" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .pagination {
            display: flex;
            justify-content: center;
        }
    </style>
    <script>

        var user_name = localStorage.getItem('user_name')
        var sub_name = localStorage.getItem('sub_name')
        var user_img_url = localStorage.getItem('user_img_url')
        if(user_name==null){
            alert("이미 로그아웃된 사용자입니다. 다시 로그인해주세요.")
            window.location.href="http://localhost:5000/"
        }
        $(document).ready(function () {
            showProfile();
            showBoardList(1);
        });

        function showProfile(code) {
            var to_html = `<img src="${user_img_url}" class="rounded" width="155">`
            $('#profile_img').append(to_html)
            $('#name').append(user_name)
            $('#sub').append(sub_name)
        }


        function showBoardList(pageNum) {
            var data = getPageData(pageNum);
            $('#board-list').empty();
            for (var i = 0;i < 10;i++){
                var to_html = `<<tr>
                            <td>${i}</td>
                            <td>TEST ${i}</td>
                            <td>author${i}</td>
                            <td>2021-05-06</td>
                        </tr>`
                $('#board-list').append(to_html)
            }
        }
        function getPageData(page){
            //여기에 페이지 수를 넘기면 게시물을 반환하는 API 작성
            pagination(page,100);
        }
        function pagination(page, totalCount){
            $('#pagination').empty();
            // page : 현재 페이지, totalCount :  전체 게시물 갯수
            var countList=10; //한 페이지에 출력될 게시물 수
            var countPage=7; //한 화면에 출력될 페이지 수
            var totalPage = parseInt(totalCount / countList);
            var to_html=``;
            if (totalCount % countList > 0) {
                totalPage++;
            }
            if (totalPage < page) {
                page = totalPage;
            }
            var startPage = (parseInt((page-1)/countPage))*countPage+1;
            var endPage = startPage + countPage - 1;
            if (endPage > totalPage) {
                endPage = totalPage;
            }
            if (page > 1) {
                to_html+=`<li><button onclick="showBoardList(${page-1})" class="button">Prev</button></li>`
            }else to_html+=`<li><button onclick="showBoardList(1)" class="button disabled">Prev</button></li>`

            for (var iCount = startPage; iCount <= endPage; iCount++) {
                if (iCount == page) {
                    to_html+=`<li><a href="javascript:showBoardList(${iCount})" class="page active">${iCount}</a></li>`
                } else {
                    to_html+=`<li><a href="javascript:showBoardList(${iCount})" class="page">${iCount}</a></li>`
                }
            }
            if (page < totalPage) {
                to_html+=`<li><button onclick="showBoardList(${page+1})" class="button">Next</button></li>`
            }else to_html+=`<li><button onclick="showBoardList(${totalPage})" class="button disabled">Next</button></li>`
            $('#pagination').append(to_html);
        }
    </script>
</head>
<body class="is-preload">

<!-- Wrapper -->
<div id="wrapper">

    <!-- Main -->
    <div id="main">
        <div class="inner">

            <!-- Header -->
            <header id="header">
                <a href="/board" class="logo"><strong>승선99</strong>자유 게시판</a>
            </header>
            <br>
            <div class="content">
                <div class="table-wrapper">
                    <table class="alt">
                        <thead>
                        <tr>
                            <th width="5%">Index</th>
                            <th width="60%">제목</th>
                            <th width="15%">작성자</th>
                            <th width="20%">작성일</th>
                        </tr>
                        </thead>
                        <tbody id="board-list">
                        </tbody>
                    </table>
                </div>
                <div style="float: right;">
                    <a href="#" class="button primary">글쓰기</a>
                </div>
                <ul class="pagination" id="pagination">
                </ul>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div id="sidebar">
        <div class="inner">
            <!-- Menu -->
            <nav id="menu">
                <header class="major">
                    <h2>Menu</h2>
                </header>
                <ul>
                    <li><a href="/study">Study</a></li>
                    <li><a href="/board">Board</a></li>
                    <li><a href="/logout">log out</a></li>
                </ul>
            </nav>

            <!-- Section -->
            <section>
                <header class="major">
                    <h2>My info</h2>
                </header>
                <div class="mini-posts">
                    <article>
                        <a href="#" class="image" id="profile_img"></a>
                        <p id="name"></p>
                        <p id="sub"></p>
                    </article>
                </div>
            </section>

            <!— Footer —>
            <footer id="footer">
                <p class="copyright">&copy; 승선99. All rights reserved. <br>항해99 2기 김예지, 오일교, 이호진, 정창길, 한주연.<br>
                    Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
            </footer>

        </div>
    </div>

</div>

<!— Scripts —>
<script src="../static/assets/js/jquery.min.js"></script>
<script src="../static/assets/js/browser.min.js"></script>
<script src="../static/assets/js/breakpoints.min.js"></script>
<script src="../static/assets/js/util.js"></script>
<script src="../static/assets/js/main.js"></script>

</body>
</html>